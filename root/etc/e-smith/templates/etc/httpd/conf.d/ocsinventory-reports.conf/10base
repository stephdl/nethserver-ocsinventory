{

my $allow = (($ocsinventory{'access'} || 'private') eq 'public') ? 'all granted':"ip $localAccess";
my $status = $ocsinventory{'status'} || "disabled";
my $name = $ocsinventory{'Name'} || 'ocsreports';

return '#ocsinventory disabled by its status property' unless ($status eq 'enabled');

$OUT .= <<EOF
#
# 10base
#
Alias /$name /usr/share/ocsinventory-reports/ocsreports
Alias /download /var/lib/ocsinventory-reports/download


<Directory /usr/share/ocsinventory-reports/ocsreports>
    Options Indexes FollowSymLinks
    DirectoryIndex index.php
    php_flag file_uploads on
    php_value post_max_size 51M
    php_value upload_max_filesize 50M
    
    SSLRequireSSL
    AuthName "OcsInventory"

    <RequireAll>
    Require $allow 
    </RequireAll>

</Directory>
EOF
}
